<app-breadcrumb-menu [items_menu]="items_menu" [home]="home"></app-breadcrumb-menu>

<div class="grid animation-duration-500 box">
    <div class="col-12">
        <div class="card">
            <div class="row">
                <div class="md:col-3 p-fluid">
                    <h6>Reason Name</h6>
                    <input pInputText id="reason_name" type="text"
                        [(ngModel)]="reasonName" placeholder="Search by Reason Name" />
                </div>
            </div>
        </div>
    </div>
</div>

<div class="grid">
    <div class="col-12">
        <div class="row">
            <p-toolbar>
                <div class="p-toolbar-group-left flex flex-wrap">
                    <button pButton type="button" label="Filter" [loading]="isLoading_Filter" icon="pi pi-search"
                        (click)="loadData(1)" class="p-button-sm mr-2 mt-2"></button>

                    <button pButton pRipple label="New" icon="pi pi-plus" (click)="openAddForm()"
                        class="p-button-sm mr-2 mt-2"></button>

                    <i class="pi pi-bars p-toolbar-separator"></i>

                    <button pButton type="button" pTooltip="Show Filter" pStyleClass=".box" enterClass="hidden"
                        enterActiveClass="fadeinup" (click)="ShowHideFilter()" tooltipPosition="top" icon="pi pi-eye"
                        class=" p-button-success mr-2 mt-2"
                        [ngStyle]="{'display' : showFilter === 1 ? 'none' : 'flex'}"></button>

                    <button pButton type="button" pTooltip="Hide Filter" (click)="ShowHideFilter()"
                        tooltipPosition="top" icon="pi pi-eye-slash" class="p-button-warning mr-2 mt-2"
                        pStyleClass=".box" leaveActiveClass="fadeoutup" leaveToClass="hidden"
                        [ngStyle]="{'display' : showFilter === 0 ? 'none' : 'flex'}"></button>
                </div>
            </p-toolbar>
        </div>
    </div>
</div>

<div class="card">
    <p-table #dt [value]="listReason" [rowHover]="true" paginatorPosition="top" [globalFilterFields]="['reason_id', 'created_date']" *ngIf="listReason && listReason.length > 0"
        [paginator]="true" [first]="first" [rows]="20" [rowsPerPageOptions]="[20, 50, 100]" dataKey="id" styleClass="p-datatable-gridlines" (onPage)="onPageChange($event)">
        <ng-template pTemplate="caption">
            Total Item: {{ totalRecords }}
        </ng-template>
        <ng-template pTemplate="header">
            <tr class="text-lg">
                <th class="text-center md:col-2" pSortableColumn="reason_id">Reason ID <p-sortIcon
                    field="reason_id"></p-sortIcon></th>
                <th class="text-center md:col-2">Reason Name</th>
                <th class="text-center md:col-2" pSortableColumn="created_date">Created date <p-sortIcon
                        field="created_date"></p-sortIcon>
                </th>
                <th class="text-center md:col-2">Created & Updated by</th>
                <th class="text-center md:col-2">Action</th>
            </tr>
        </ng-template>
        <ng-template pTemplate="body" let-item>
            <tr [pSelectableRow]="item">
                <td class="text-center md:col-2">
                    <span class="font-medium">{{ item.reason_id }}</span>
                </td>
                <td class="text-start md:col-2">
                    <span class="font-medium">{{ item.reason_name }}</span>
                </td>
                <td class="text-center md:col-2">
                    <span class="font-medium">{{ item.created_date }}</span>
                </td>
                <td class="text-center md:col-2">
                    <span class="font-medium" pTooltip="Created at {{item.created_date}}" [fitContent]="true" tooltipPosition="top">{{ item.created_by }}</span>
                </td>
                <td class="text-center flex flex-row align-items-center justify-content-center gap-3 px-7 w-full h-full">
                    <button class="p-button-rounded p-button-text" pButton pRipple type="button" icon="pi pi-pencil"
                        (click)="openEditForm(item.project_id, item.reason_id, item.reason_name)">
                    </button>
                    <button class="p-button-rounded p-button-danger p-button-text" pButton pRipple type="button" icon="pi pi-trash"
                        (click)="openDelete(item.project_id, item.reason_id, item.reason_name, $event)">
                    </button>
                    <p-confirmPopup></p-confirmPopup>
                </td>
            </tr>
        </ng-template>
    </p-table>
    <div class="card flex justify-content-center justify-content-between text-center "
        *ngIf="listReason && listReason.length === 0" style="float: right;">
        <h5>No data</h5>
    </div>
</div>

<p-dialog [(visible)]="newReasonDialog" [style]="{ width: '60rem', height: 'fit-content' }"
    header="Create new Reason Inventory" [modal]="true" styleClass="p-fluid" [closable]="true"
    (onHide)="resetNewReasonDialog()">

    <ng-template pTemplate="content">
        <div class="field w-12">
            <label for="reason_name">Reason Name</label>
            <input type="text" pInputText id="reason_name" [(ngModel)]="reasonName"
                placeholder="Please fill in Reason Name" />
        </div>
    </ng-template>

    <ng-template pTemplate="footer">
        <button pButton pRipple label="Reset all data input" icon="pi pi-times" class="p-button-text"
            (click)="resetInputNewReason()"></button>
        <p-confirmDialog></p-confirmDialog>
        <button pButton pRipple label="Save" icon="pi pi-check" class="p-button-text"
            (click)="saveNewReason($event)"></button>
    </ng-template>
</p-dialog>

<p-dialog [(visible)]="editReasonDialog" [style]="{ width: '60rem', height: 'fit-content' }"
    header="Edit Config Inventory" [modal]="true" styleClass="p-fluid" [closable]="true"
    (onHide)="resetEditInvenDialog()">

    <ng-template pTemplate="content">
        <div class="flex flex-row w-full h-fit align-items-center justify-content-between gap-3">
            <div class="field w-6">
                <label for="projectId">Project<span class="font-bold" style="color: red;"> *</span></label>
                <input type="text" pInputText id="projectId" [value]="editInfoProject" [disabled]="true" />
            </div>

            <div class="field w-6">
                <label for="reason_id">Reason ID</label>
                <input type="text" pInputText id="reason_id" [value]="editReasonId" [disabled]="true" />
            </div>
        </div>

        <div class="field w-12">
            <label for="reason_name">Reason Name</label>
            <input type="text" pInputText id="reason_name" [(ngModel)]="editReasonName"
                placeholder={{editReasonName}} />
        </div>
    </ng-template>

    <ng-template pTemplate="footer">
        <button pButton pRipple label="Reset all data input" icon="pi pi-times" class="p-button-text"
            (click)="resetInputEditInven()"></button>
        <p-confirmDialog></p-confirmDialog>
        <button pButton pRipple label="Save" icon="pi pi-check" class="p-button-text"
            (click)="saveEditReason($event)"></button>
    </ng-template>
</p-dialog>