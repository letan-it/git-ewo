<!-- eslint-disable @angular-eslint/template/eqeqeq -->
<div
    class="card flex justify-content-center"
    *ngIf="
        inValue &&
        inValue.length > 0 &&
        listATDShift &&
        listATDShift.getItem &&
        listATDShift.getItem.length > 0
    "
    style="border: hidden"
>
    <p-accordion
        class="w-full"
        *ngFor="let shift of listATDShift.getItem; let i = index"
        [activeIndex]="i"
        class="mb-2"
    >
        <!-- *ngIf="shift.checkShow == 1" -->
        <p-accordionTab [header]="''">
            <ng-template pTemplate="header">
                <span
                    class="flex align-items-center gap-2 w-full"
                    *ngIf="shift.shift_code && shift.shift_code != null"
                >
                    <span class="font-bold white-space-nowrap">
                        <span style="color: green"
                            >[{{ shift.shift_code }}]</span
                        >
                        - {{ shift.shift_note }}</span
                    >
                </span>
            </ng-template>
            <div class="grid">
                <div class="col-12">
                    <div class="row flex-row">
                        <!-- CHECKIN- CHECKOUT - OVIEW -->
                        <div class="md:col-9">
                            <div class="grid">
                                <div class="col-12">
                                    <div class="row flex-row">
                                        <div
                                            class="md:col-4"
                                            *ngFor="
                                                let item of shift;
                                                let i = index
                                            "
                                        >
                                            <div
                                                class="card flex justify-contnet-center align-items-center"
                                            >
                                                <div
                                                    class="flex flex-row w-100 justify-content-end"
                                                    *ngIf="
                                                        inValue.isdelete_ATD &&
                                                        inValue.isdelete_ATD ==
                                                            1
                                                    "
                                                >
                                                    <i
                                                        *ngIf="
                                                            item.isBsc &&
                                                            item.isBsc == 1
                                                        "
                                                        class="pi pi-info-circle"
                                                        style="
                                                            color: red;
                                                            font-size: 2rem;
                                                        "
                                                        pTooltip="Công bổ sung"
                                                        tooltipPosition="top"
                                                    ></i>
                                                    <i
                                                        *ngIf="
                                                            item.atd_type &&
                                                            item.atd_type !=
                                                                'OVERVIEW'
                                                        "
                                                        class="pi pi-times ml-2 cursor-pointer"
                                                        style="
                                                            color: red;
                                                            font-size: 2rem;
                                                        "
                                                        (click)="
                                                            delete($event, item)
                                                        "
                                                        pTooltip="Xóa công"
                                                        tooltipPosition="top"
                                                    ></i>
                                                </div>

                                                <div
                                                    class="flex flex-row w-100 justify-content-center align-items-center"
                                                >
                                                    <h6 class="text-center">
                                                        {{ item.atd_type }}
                                                    </h6>
                                                </div>
                                                <div
                                                    class="flex flex-column gap-3"
                                                >
                                                    <h5
                                                        class="text-center font-bold"
                                                    >
                                                        {{ item.atd_time }}
                                                    </h5>
                                                </div>
                                                <div
                                                    class="flex flex-column gap-3"
                                                    *ngIf="item.distance"
                                                >
                                                    <p
                                                        class="text-center cursor_pointer"
                                                    >
                                                        <p-tag
                                                            pTooltip="Distance"
                                                            tooltipPosition="top"
                                                            (click)="
                                                                op.toggle(
                                                                    $event
                                                                )
                                                            "
                                                            icon="pi pi-external-link"
                                                        ></p-tag>
                                                    </p>
                                                    <p-overlayPanel #op>
                                                        <ng-template
                                                            pTemplate="content"
                                                        >
                                                            Khoảng cách giữa vị
                                                            trí
                                                            {{ item.atd_type }}
                                                            so với vị trí cửa
                                                            hàng là: ~{{
                                                                item.distance
                                                            }}
                                                            mét
                                                        </ng-template>
                                                    </p-overlayPanel>
                                                </div>
                                                <!-- item.atd_type ==
                                                        'OVERVIEW'
                                                            ? 'flex flex-column gap-3'
                                                            : 'flex flex-column gap-3' -->

                                                <div
                                                    [class]="
                                                        item.atd_type ==
                                                        'OVERVIEW'
                                                            ? 'flex flex-column gap-3 mt-7'
                                                            : 'flex flex-column gap-3'
                                                    "
                                                >
                                                    <p
                                                        class="text-center cursor_pointer"
                                                    >
                                                        MAP

                                                        <p-image
                                                            (click)="
                                                                mapPopup(
                                                                    item.latitude,
                                                                    item.longitude
                                                                )
                                                            "
                                                            [src]="
                                                                getSrcMap(
                                                                    item.atd_type
                                                                )
                                                            "
                                                            alt=" Image"
                                                            width="20px"
                                                        ></p-image>

                                                        <span
                                                            *ngIf="
                                                                item.verify !=
                                                                null
                                                            "
                                                        >
                                                            <!-- item.employee_image -->
                                                            / Verify:
                                                            <span
                                                                ><p-avatar
                                                                    (onImageError)="
                                                                        onImageErrorProfile(
                                                                            $event,
                                                                            item
                                                                        )
                                                                    "
                                                                    [image]="
                                                                        employee_image
                                                                    "
                                                                    pBadge
                                                                    [value]="
                                                                        item.verify ==
                                                                        0
                                                                            ? 'x'
                                                                            : 'v'
                                                                    "
                                                                    [severity]="
                                                                        item.verify ==
                                                                        0
                                                                            ? 'danger'
                                                                            : 'success'
                                                                    "
                                                                ></p-avatar
                                                            ></span>
                                                        </span>
                                                    </p>
                                                </div>

                                                <div
                                                    class="flex flex-column gap-3 text-center mt-2"
                                                >
                                                    <p-image
                                                        (onImageError)="
                                                            onImageError(
                                                                $event,
                                                                item
                                                            )
                                                        "
                                                        (dblclick)="
                                                            openImage(
                                                                i + 1,
                                                                shift.listphoto
                                                            )
                                                        "
                                                        [src]="item.atd_photo"
                                                        alt="Image"
                                                        height="150"
                                                    ></p-image>
                                                    <hr />
                                                </div>
                                                <div
                                                    class="flex flex-column gap-3 text-center"
                                                >
                                                    <!--  && false -->
                                                    <p-button
                                                        *ngIf="
                                                            permission_full ==
                                                                1 &&
                                                            inValue.is_edit_data ==
                                                                1 &&
                                                            false
                                                        "
                                                        class="p-button-rounded p-button-text p-button-sm mb-2"
                                                        onclick="document.getElementById('myInputImage').click()"
                                                        >Change Image
                                                        {{
                                                            item.atd_type
                                                        }}</p-button
                                                    >
                                                </div>

                                                <!--  style="visibility: hidden" -->
                                                <div
                                                    class="flex flex-column gap-3 text-center"
                                                >
                                                    <!--  style="width: 20%;" -->
                                                    <input
                                                        style="width: 100%"
                                                        class="cursor_pointer text-center"
                                                        type="file"
                                                        id="myInputImage"
                                                        (change)="
                                                            onUploadImge(
                                                                $event,
                                                                item.atd_type,
                                                                item
                                                            )
                                                        "
                                                        *ngIf="
                                                        permission_full ==
                                                            1 &&
                                                        inValue.is_edit_data ==
                                                            1  
                                                        "

                                                        [pTooltip]="
                                                            item.nameInputFile
                                                        "
                                                        tooltipPosition="top"
                                                    />
                                                </div>

                                                <div
                                                    class="flex flex-column gap-3 text-center"
                                                >
                                                    <p-button
                                                        [style]="{
                                                            width: '100%'
                                                        }"
                                                        (click)="
                                                            onUpdateAvatar(
                                                                'employee',
                                                                item
                                                            )
                                                        "
                                                        *ngIf="
                                                            permission_full ==
                                                                1 &&
                                                            inValue.is_edit_data ==
                                                                1 &&
                                                            item.atd_type !=
                                                                'OVERVIEW'
                                                        "
                                                        styleClass="text-center p-button-raised p-button-text p-button-success mt-2"
                                                    >
                                                        <span
                                                            class="text-center"
                                                            >Making an
                                                            employee's
                                                            avatar</span
                                                        ></p-button
                                                    >
                                                    <!-- p-button-sm -->

                                                    <p-button
                                                        [style]="{
                                                            width: '100%'
                                                        }"
                                                        (click)="
                                                            onUpdateAvatar(
                                                                'shop',
                                                                item
                                                            )
                                                        "
                                                        *ngIf="
                                                            permission_full ==
                                                                1 &&
                                                            item.is_edit_data ==
                                                                1 &&
                                                            item.atd_type ==
                                                                'OVERVIEW'
                                                        "
                                                        styleClass="p-button-raised p-button-text p-button-success mt-2"
                                                        >Use as an overview of
                                                        the store</p-button
                                                    >
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- TIME SHOP -->
                        <div
                            class="md:col-3 mt-3"
                            *ngIf="shift && shift.time_in_store"
                        >
                            <div class="card flex justify-content-center">
                                <div class="flex flex-column gap-3">
                                    <h6 class="text-center">
                                        Thời gian tại cửa hàng
                                    </h6>
                                </div>
                                <div class="flex flex-column gap-3">
                                    <h5 class="text-center font-bold">
                                        {{ shift.time_in_store }}
                                    </h5>
                                </div>

                                <div class="flex flex-column gap-3">
                                    <p-image
                                        src="https://maps.googleapis.com/maps/api/staticmap?center={{
                                            shift._latitudeCheckIn
                                        }},{{
                                            shift._longitudeCheckIn
                                        }}&zoom=18&size=600x300&maptype=roadmap&markers=color:red%7Clabel:Shop%7C{{
                                            shift._latitudeCheckIn
                                        }},{{
                                            shift._longitudeCheckIn
                                        }}&markers=color:blue%7Clabel:Marker1%7C{{
                                            shift._latitudeCheckOut
                                        }},{{
                                            shift._longitudeCheckOut
                                        }}&key=AIzaSyAa8HeLH2lQMbPeOiMlM9D1VxZ7pbGQq8o"
                                        alt="Image"
                                        width="100%"
                                    ></p-image>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </p-accordionTab>
    </p-accordion>
</div>

<div
    class="card flex justify-content-center"
    *ngIf="
        inValue &&
        inValue.length > 0 &&
        listShift &&
        listShift.length > 0 &&
        false
    "
    style="border: hidden"
>
    <p-accordion
        class="w-full"
        *ngFor="let shift of listShift; let i = index"
        [activeIndex]="i"
        class="mb-2"
    >
        <p-accordionTab [header]="''" *ngIf="shift.checkShow == 1">
            <ng-template pTemplate="header">
                <span class="flex align-items-center gap-2 w-full">
                    <span class="font-bold white-space-nowrap">
                        <span style="color: green"
                            >[{{ shift.shift_code }}]</span
                        >
                        - {{ shift.note }}</span
                    >
                    <!-- <p-badge value="3" class="ml-auto" /> -->
                </span>
            </ng-template>

            <div class="grid">
                <div class="col-12">
                    <div class="row flex-row">
                        <!-- CHECKIN- CHECKOUT - OVIEW -->
                        <div class="md:col-9">
                            <div class="grid">
                                <div class="col-12">
                                    <div class="row flex-row">
                                        <div
                                            class="md:col-4"
                                            *ngFor="
                                                let item of shift.getItem;
                                                let i = index
                                            "
                                        >
                                            <div
                                                class="card flex justify-content-center"
                                            >
                                                <div
                                                    class="flex flex-column gap-3"
                                                >
                                                    <h6 class="text-center">
                                                        {{ item.atd_type }}
                                                    </h6>
                                                </div>
                                                <div
                                                    class="flex flex-column gap-3"
                                                >
                                                    <h5
                                                        class="text-center font-bold"
                                                    >
                                                        {{ item.atd_time }}
                                                    </h5>
                                                </div>
                                                <div
                                                    class="flex flex-column gap-3"
                                                    *ngIf="item.distance"
                                                >
                                                    <p
                                                        class="text-center cursor_pointer"
                                                    >
                                                        <p-tag
                                                            pTooltip="Distance"
                                                            tooltipPosition="top"
                                                            (click)="
                                                                op.toggle(
                                                                    $event
                                                                )
                                                            "
                                                            icon="pi pi-external-link"
                                                        ></p-tag>
                                                    </p>
                                                    <p-overlayPanel #op>
                                                        <ng-template
                                                            pTemplate="content"
                                                        >
                                                            Khoảng cách giữa vị
                                                            trí
                                                            {{ item.atd_type }}
                                                            so với vị trí cửa
                                                            hàng là: ~{{
                                                                item.distance
                                                            }}
                                                            mét
                                                        </ng-template>
                                                    </p-overlayPanel>
                                                </div>
                                                <div
                                                    [class]="
                                                        item.atd_type ==
                                                        'OVERVIEW'
                                                            ? 'flex flex-column gap-3'
                                                            : 'flex flex-column gap-3'
                                                    "
                                                >
                                                    <p
                                                        class="text-center cursor_pointer"
                                                    >
                                                        MAP
                                                        <p-image
                                                            (click)="
                                                                mapPopup(
                                                                    item.latitude,
                                                                    item.longitude
                                                                )
                                                            "
                                                            [src]="
                                                                getSrcMap(
                                                                    item.atd_type
                                                                )
                                                            "
                                                            alt=" Image"
                                                            width="20px"
                                                        ></p-image>

                                                        <span
                                                            *ngIf="
                                                                item.verify !=
                                                                null
                                                            "
                                                        >
                                                            <!-- item.employee_image -->
                                                            / Verify:
                                                            <span
                                                                ><p-avatar
                                                                    (onImageError)="
                                                                        onImageErrorProfile(
                                                                            $event,
                                                                            item
                                                                        )
                                                                    "
                                                                    [image]="
                                                                        employee_image
                                                                    "
                                                                    pBadge
                                                                    [value]="
                                                                        item.verify ==
                                                                        0
                                                                            ? 'x'
                                                                            : 'v'
                                                                    "
                                                                    [severity]="
                                                                        item.verify ==
                                                                        0
                                                                            ? 'danger'
                                                                            : 'success'
                                                                    "
                                                                ></p-avatar
                                                            ></span>
                                                        </span>
                                                    </p>
                                                </div>

                                                <div
                                                    class="flex flex-column gap-3 text-center mt-2"
                                                >
                                                    <p-image
                                                        (onImageError)="
                                                            onImageError(
                                                                $event,
                                                                item
                                                            )
                                                        "
                                                        (dblclick)="
                                                            openImage(
                                                                i + 1,
                                                                shift.getItem
                                                                    .listphoto
                                                            )
                                                        "
                                                        [src]="item.atd_photo"
                                                        alt="Image"
                                                        height="150"
                                                    ></p-image>
                                                    <hr />
                                                </div>
                                                <div
                                                    class="flex flex-column gap-3 text-center"
                                                >
                                                    <!--  && false -->
                                                    <p-button
                                                        *ngIf="
                                                            permission_full ==
                                                                1 &&
                                                            inValue.is_edit_data ==
                                                                1 &&
                                                            false
                                                        "
                                                        class="p-button-rounded p-button-text p-button-sm mb-2"
                                                        onclick="document.getElementById('myInputImage').click()"
                                                        >Change Image
                                                        {{
                                                            item.atd_type
                                                        }}</p-button
                                                    >
                                                </div>

                                                <!--  style="visibility: hidden" -->
                                                <div
                                                    class="flex flex-column gap-3 text-center"
                                                >
                                                    <input
                                                        class="cursor_pointer text-center"
                                                        type="file"
                                                        id="myInputImage"
                                                        (change)="
                                                            onUploadImge(
                                                                $event,
                                                                item.atd_type,
                                                                item
                                                            )
                                                        "
                                                        [pTooltip]="
                                                            item.nameInputFile
                                                        "
                                                        tooltipPosition="top"
                                                    />
                                                </div>

                                                <div
                                                    class="flex flex-column gap-3 text-center"
                                                >
                                                    <p-button
                                                        [style]="{
                                                            width: '100%'
                                                        }"
                                                        (click)="
                                                            onUpdateAvatar(
                                                                'employee',
                                                                item
                                                            )
                                                        "
                                                        *ngIf="
                                                            permission_full ==
                                                                1 &&
                                                            inValue.is_edit_data ==
                                                                1 &&
                                                            item.atd_type !=
                                                                'OVERVIEW'
                                                        "
                                                        styleClass="text-center p-button-raised p-button-text p-button-success mt-2"
                                                    >
                                                        <span
                                                            class="text-center"
                                                            >Making an
                                                            employee's
                                                            avatar</span
                                                        ></p-button
                                                    >
                                                    <!-- p-button-sm -->

                                                    <p-button
                                                        [style]="{
                                                            width: '100%'
                                                        }"
                                                        (click)="
                                                            onUpdateAvatar(
                                                                'shop',
                                                                item
                                                            )
                                                        "
                                                        *ngIf="
                                                            permission_full ==
                                                                1 &&
                                                            item.is_edit_data ==
                                                                1 &&
                                                            item.atd_type ==
                                                                'OVERVIEW'
                                                        "
                                                        styleClass="p-button-raised p-button-text p-button-success mt-2"
                                                        >Use as an overview of
                                                        the store</p-button
                                                    >
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- TIME SHOP -->
                        <div
                            class="md:col-3 mt-3"
                            *ngIf="
                                shift &&
                                shift.getItem &&
                                shift.getItem.time_in_store
                            "
                        >
                            <div class="card flex justify-content-center">
                                <div class="flex flex-column gap-3">
                                    <h6 class="text-center">
                                        Thời gian tại cửa hàng
                                    </h6>
                                </div>
                                <div class="flex flex-column gap-3">
                                    <h5 class="text-center font-bold">
                                        {{ shift.getItem.time_in_store }}
                                    </h5>
                                </div>

                                <div class="flex flex-column gap-3">
                                    <p-image
                                        src="https://maps.googleapis.com/maps/api/staticmap?center={{
                                            shift.getItem._latitudeCheckIn
                                        }},{{
                                            shift.getItem._longitudeCheckIn
                                        }}&zoom=18&size=600x300&maptype=roadmap&markers=color:red%7Clabel:Shop%7C{{
                                            shift.getItem._latitudeCheckIn
                                        }},{{
                                            shift.getItem._longitudeCheckIn
                                        }}&markers=color:blue%7Clabel:Marker1%7C{{
                                            shift.getItem._latitudeCheckOut
                                        }},{{
                                            shift.getItem._longitudeCheckOut
                                        }}&key=AIzaSyAa8HeLH2lQMbPeOiMlM9D1VxZ7pbGQq8o"
                                        alt="Image"
                                        width="100%"
                                    ></p-image>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </p-accordionTab>
    </p-accordion>
</div>
